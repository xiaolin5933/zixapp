### 协议举例：
```
从2012-10-01 ~ 2013-09-30
包年12万， 按月进行财务确认
```


### 规则设置

```
规则组1 => {
    dir     => 1,  # 入金交易
    rules   => [
        {
            ack     => 2,   # 周期确认
            dir     => 2,   # 付银行手续费
            sect    => [
                {
                    begin   => 0,
                    end     => 999999999999999999,
                    mode    => 2,                     # 按定额
                    quota   => 1块,                   # 定额1块
                },
            ],
            ack_id  => 确认规则1,                     # 确认规则ID
        }
    ]
};

确认规则1 => {
    ack_period  => [
        {
            begin   => 2012-10-01,
            end     => 2013-10-31,
            ceiling => 1万,         # 暂估手续费封顶
            floor   => 1万,         # 暂估手续费保底
        },
        {
            begin   => 2012-11-01,
            end     => 2013-11-30,
            ceiling => 1万,         # 暂估手续费封顶
            floor   => 1万,         # 暂估手续费保底
        },
        {
            begin   => 2012-12-01,
            end     => 2013-12-31,
            ceiling => 1万,         # 暂估手续费封顶
            floor   => 1万,         # 暂估手续费保底
        },
        {
            begin   => 2013-01-01,
            end     => 2013-01-31,
            ceiling => 1万,         # 暂估手续费封顶
            floor   => 1万,         # 暂估手续费保底
        },
        {
            begin   => 2013-02-01,
            end     => 2013-02-29,
            ceiling => 1万,         # 暂估手续费封顶
            floor   => 1万,         # 暂估手续费保底
        },
        {
            begin   => 2013-03-01,
            end     => 2013-03-31
            ceiling => 1万,         # 暂估手续费封顶
            floor   => 1万,         # 暂估手续费保底
        },
        {
            begin   => 2013-04-01,
            end     => 2013-04-30,
            ceiling => 1万,         # 暂估手续费封顶
            floor   => 1万,         # 暂估手续费保底
        },
        {
            begin   => 2013-05-01,
            end     => 2013-05-31,
            ceiling => 1万,         # 暂估手续费封顶
            floor   => 1万,         # 暂估手续费保底
        },
        {
            begin   => 2013-06-01,
            end     => 2013-06-30,
            ceiling => 1万,         # 暂估手续费封顶
            floor   => 1万,         # 暂估手续费保底
        },
        {
            begin   => 2013-07-01,
            end     => 2013-07-31,
            ceiling => 1万,         # 暂估手续费封顶
            floor   => 1万,         # 暂估手续费保底
        },
        {
            begin   => 2013-08-01,
            end     => 2013-08-31,
            ceiling => 1万,         # 暂估手续费封顶
            floor   => 1万,         # 暂估手续费保底
        },
        {
            begin   => 2013-09-01,
            end     => 2013-09-30,
            ceiling => 1万,         # 暂估手续费封顶
            floor   => 1万,         # 暂估手续费保底
        },
    ],
    ack_type    => 1, # 1 包周期(月，年); 2 阶梯; 3 分段
    ack_sect    => [
    ],
    hf          => {},
};
```

### 算法描述

#### 1. 假设

因为是包年, 那么暂估逐笔区间必须为下列之一:

- 单笔定额 
- 或区间比例

假设为单笔定额1块。 


#### 2. 暂估阶段
按单笔1块算暂估手续费，且入暂估手续费账薄

#### 3. 确认阶段
1. 根据所传入的`周期2013-08-31`与`确认规则1`, 
   此日期或者此日期前的某一天要达到我们此确认规则的某一确认周期为
   (2013-08-01 ~ 2013-08-31)的最后一天，我们开始确认。

2. 判断确认类型ack_type, 如果为1 包周期, 执行下步

3. 根据实际情况取此日期区间的ceiling值，结果1万。
